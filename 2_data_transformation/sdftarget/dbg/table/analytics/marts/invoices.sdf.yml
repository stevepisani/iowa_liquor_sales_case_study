table:
  name: analytics.marts.invoices
  description: A denormalized table of invoices with all relevant information.
  dialect: snowflake
  materialization: table
  purpose: model
  dependencies:
  - analytics.aux.int_categories
  - analytics.aux.int_invoices
  - analytics.aux.int_items
  - analytics.aux.int_stores
  - analytics.aux.int_vendors
  columns:
  - name: invoice_id
    description: A unique ID number for each invoice.
    datatype: bigint
    lineage:
      copy:
      - analytics.aux.int_invoices.invoice_id
  - name: invoice_date
    datatype: date
    lineage:
      copy:
      - analytics.aux.int_invoices.invoice_date
  - name: state_bottle_cost
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.state_bottle_cost
  - name: state_bottle_retail
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.state_bottle_retail
  - name: number_of_bottles_sold
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_invoices.number_of_bottles_sold
  - name: sale_in_dollars
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.sale_in_dollars
  - name: cost_in_dollars
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.cost_in_dollars
  - name: profit_in_dollars
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.profit_in_dollars
  - name: volume_sold_liters
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.volume_sold_liters
  - name: volume_sold_gallons
    datatype: real
    lineage:
      copy:
      - analytics.aux.int_invoices.volume_sold_gallons
  - name: store_id
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_invoices.store_id
  - name: store_name
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_stores.store_name
  - name: store_brand_name
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_stores.store_brand_name
  - name: category_id
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_invoices.category_id
  - name: category_name
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_categories.category_name
  - name: liquor_type_name
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_categories.liquor_type_name
  - name: vendor_id
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_invoices.vendor_id
  - name: vendor_name
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_vendors.vendor_name
  - name: item_id
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_invoices.item_id
  - name: item_description
    datatype: varchar
    lineage:
      copy:
      - analytics.aux.int_items.item_description
  - name: number_of_bottles_in_pack
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_items.number_of_bottles_in_pack
  - name: bottle_volume_ml
    datatype: decimal(38, 0)
    lineage:
      copy:
      - analytics.aux.int_items.bottle_volume_ml
  lineage:
    scan:
    - analytics.aux.int_categories.category_id
    - analytics.aux.int_invoices.category_id
    - analytics.aux.int_invoices.item_id
    - analytics.aux.int_invoices.store_id
    - analytics.aux.int_invoices.vendor_id
    - analytics.aux.int_items.item_id
    - analytics.aux.int_stores.store_id
    - analytics.aux.int_vendors.vendor_id
  source-locations:
  - path: target/compiled/sdf/models/analytics/marts/invoices.sdf.yml
  - path: target/compiled/sdf/models/analytics/marts/invoices.sql
